# Particle Gibbs for Bayesian classification and structure learning in decomposable graphical models
A graphical predictive classifier and a particle Gibbs sampler for Bayesian structure learning in discrete log-linear and Gaussian decomposable graphical models.

### Installation

If graphviz is not installed, you can install it from brew / aptitude / pacman for example
```
$ brew install graphviz
```
Then run
```
$ pip install trilearn
```

### Running the tests

```
$ make test
```

## Scripts
### Continuous data
To approximate the underlying decomposable graph posterior given the dataset sample_data/data_ar1-5.csv run
```
$ pgibbs_ggm_sample -N 50 -M 1000 -f sample_data/data_ar1-5.csv
```
this will produce a file containing the Markov chain generated by the particle Gibbs algorithm. 
In order to analyze the chain run
```
$ analyze_graph_tajectories
```
this will produce a bunch of files in the current directory to be analyzed.

### Discrete data
The data set examples/data/czech_autoworkers.csv contains six binary variables.
To generate a particle Gibbs trajectory of decomposable graphs type
```
$ pgibbs_loglinear_sample -N 50 -M 300 -f sample_data/czech_autoworkers.csv
```
and
```
$ analyze_graph_tajectories
```
this will produce a number of files in the current directory.

### Estimate the number of decomposable graphs
To estimate the number of decomposable graphs with up to 15 nodes run for example
```
$ count_chordal_graphs -p 15 -N 20000
```
## Built With

* [NetworkX](https://networkx.github.io/documentation/stable/index.html)
* [NumPy](https://docs.scipy.org/doc/)
* [Scipy](https://docs.scipy.org/doc/)
* [Pandas](http://pandas.pydata.org/pandas-docs/stable/)
* [Seaborn](https://seaborn.pydata.org/api.html)
## Authors

* **Felix Rios**

## References
* [Jimmy Olsson, Tetyana Pavlenko, Felix L. Rios, Sequential sampling of junction trees for decomposable graphs,
 ArXiv 2018](https://arxiv.org/abs/1806.00584)
* [Jimmy Olsson, Tetyana Pavlenko, Felix L. Rios, Bayesian inference in decomposable graphical models using sequential Monte Carlo methods, ArXiv 2018](https://arxiv.org/abs/1805.12571)
* [Tetyana Pavlenko, Felix L. Rios, Graphical posterior predictive classifier: Bayesian model averaging with particle Gibbs, ArXiv 2018](https://arxiv.org/abs/1707.06792)

## License

This project is licensed under the Apache 2.0 License - see the [LICENSE](LICENSE) file for details

## Acknowledgments

* **Jim Holmstrom**
